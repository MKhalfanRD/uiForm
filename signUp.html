<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign Up Form</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    .error-message { opacity: 0; transform: translateY(-10px); transition: all 0.3s ease; }
    .error-message.show { opacity: 1; transform: translateY(0); }
    .input-error { border-color: #ff3860 !important; background-color: #fff5f5 !important; box-shadow: 0 0 0 3px rgba(255,56,96,0.1) !important; }
    .input-success { border-color: #48bb78 !important; background-color: #f0fff4 !important; box-shadow: 0 0 0 3px rgba(72,187,120,0.1) !important; }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center min-h-screen p-4">

  <div class="bg-white shadow-xl rounded-2xl p-8 w-full max-w-md">
    <div class="text-center mb-8">
      <h2 class="text-3xl font-bold text-gray-800">Create Account</h2>
      <p class="text-gray-600 mt-2">Sign up to get started</p>
    </div>

    <form id="registerForm">
      <!-- Username -->
      <div class="mb-5">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="regEmail">Username</label>
        <div class="relative">
          <input type="username" id="regUsername" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none transition" placeholder="Andi"/>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3">
            <i class="fa fa-user-circle text-gray-400"></i>
          </div>
        </div>
        <div id="usernameError" class="error-message text-red-500 text-xs mt-1 flex items-center">
          <i class="fa fa-exclamation-circle mr-1"></i><span></span>
        </div>
      </div>
      <!-- Email -->
      <div class="mb-5">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="regEmail">Email</label>
        <div class="relative">
          <input type="email" id="regEmail" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none transition" placeholder="your@email.com"/>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3">
            <i class="fa fa-envelope text-gray-400"></i>
          </div>
        </div>
        <div id="emailError" class="error-message text-red-500 text-xs mt-1 flex items-center">
          <i class="fa fa-exclamation-circle mr-1"></i><span></span>
        </div>
      </div>

      <!-- Password -->
      <div class="mb-6">
        <label class="block text-gray-700 text-sm font-medium mb-2" for="regPassword">Password</label>
        <div class="relative">
          <input type="password" id="regPassword" class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none transition" placeholder="••••••••"/>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3">
            <i class="fa fa-lock text-gray-400"></i>
          </div>
        </div>
        <div id="passwordError" class="error-message text-red-500 text-xs mt-1 flex items-center">
          <i class="fa fa-exclamation-circle mr-1"></i><span></span>
        </div>
      </div>

      <!-- Register Button -->
      <button type="submit" class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition focus:ring-4 focus:ring-blue-200 font-medium flex items-center justify-center">
        <i class="fa fa-user-plus mr-2"></i> Sign Up
      </button>

      <div class="mt-6 text-center">
        <p class="text-sm text-gray-600">
          Already have an account?
          <a href="index.html" class="text-blue-500 hover:text-blue-700 font-medium">Sign in</a>
        </p>
      </div>
    </form>

    <div id="successMessage" class="hidden mt-6 p-4 bg-green-100 text-green-700 rounded-lg text-center">
      <i class="fa fa-check-circle mr-2"></i>
      <span>Registration successful! Redirecting...</span>
    </div>
  </div>

  <script>
    const registerForm = document.getElementById("registerForm");
    const emailInput = document.getElementById("regEmail");
    const passwordInput = document.getElementById("regPassword");
    const emailError = document.getElementById("emailError");
    const passwordError = document.getElementById("passwordError");

    let users = JSON.parse(localStorage.getItem("users")) || [];

    registerForm.addEventListener("submit", function(e) {
      e.preventDefault();

      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();
      const successMessage = document.getElementById("successMessage");

      // Reset error state
      emailError.classList.remove("show");
      passwordError.classList.remove("show");
      emailInput.classList.remove("input-error", "input-success");
      passwordInput.classList.remove("input-error", "input-success");

      let isValid = true;

      if (!email) {
        showError(emailError, "Harap isi email", emailInput);
        isValid = false;
      } else if (!isValidEmail(email)) {
        showError(emailError, "Harap isi dengan benar", emailInput);
        isValid = false;
      } else if (users.find(u => u.email === email)) {
        showError(emailError, "Email sudah terdaftar", emailInput);
        isValid = false;
      } else {
        hideError(emailError, emailInput);
      }

      if (!password) {
        showError(passwordError, "Harap isi password", passwordInput);
        isValid = false;
      } else if (password.length < 4) {
        showError(passwordError, "Setidaknya masukkan 4 karakter", passwordInput);
        isValid = false;
      } else {
        hideError(passwordError, passwordInput);
      }

      if (!isValid) return;

      // Simpan ke localStorage
      users.push({ email, password });
      localStorage.setItem("users", JSON.stringify(users));

      successMessage.classList.remove("hidden");
      setTimeout(() => {
        window.location.href = "index.html"; // redirect ke login
      }, 2000);
    });

    function showError(element, message, inputElement) {
      element.querySelector("span").textContent = message;
      element.classList.add("show");
      if (inputElement) inputElement.classList.add("input-error");
    }

    function hideError(element, inputElement) {
      element.classList.remove("show");
      if (inputElement) inputElement.classList.add("input-success");
    }

    function isValidEmail(email) {
      const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
      return re.test(email);
    }
  </script>
</body>
</html>
